name: keg-tests
on: pull_request

jobs:
  tests:
    name: 'Run Tests'
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - name: "Get Changed Files"
        id: get-changed-files
        shell: bash
        run: bash scripts/ci/getChangedFiles.sh
      - name: "Get Changed Repos"
        id: get-changed-repos
        shell: bash
        run: bash scripts/ci/getChangedRepos.sh
      - name: "Run Repo Tests"
        id: run-repo-tests
        shell: bash
        run: bash scripts/ci/runYarnCmd.sh "test" "build"
      - name: "Commit Repo Changes"
        id: commit-changes
        shell: bash
        run: bash scripts/ci/commitChanges.sh