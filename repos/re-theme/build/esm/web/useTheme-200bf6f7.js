import e,{useContext as r}from"react";import{deepFreeze as t,hasDomAccess as n,checkCall as o,debounce as i,isArr as a,isFunc as u,isNum as f,isObj as l,logData as d,mapObj as c,softFalsy as s,toNum as p,reduceObj as y,unset as h,deepMerge as m,isEmpty as b,get as v,isStr as g}from"@keg-hub/jsutils";var _=t({BUILD_EVENT:"build",CHANGE_EVENT:"change",RESIZE_EVENT:"resize",ADD_EVENT:"addEventListener",REMOVE_EVENT:"removeEventListener",KEG_STYLES_TAG_ID:"keg-components-stylesheet",PLATFORM:{NATIVE:"$native",IOS:"$ios",android:"$android",WEB:"$web",ALL:"$all"}}),P=n()?window:{devicePixelRatio:void 0,innerHeight:void 0,innerWidth:void 0,width:void 0,height:void 0,screen:{height:void 0,width:void 0}},setScreen=function(e){return{fontScale:1,height:e.screen.height,scale:e.devicePixelRatio||1,width:e.screen.width}},setWin=function(e){return{fontScale:1,height:e.innerHeight,scale:e.devicePixelRatio||1,width:e.innerWidth}},w={window:setWin(P),screen:setScreen(P)},E={},update=function(){w.window=setWin(P),w.screen=setScreen(P),a(E[_.CHANGE_EVENT])&&E[_.CHANGE_EVENT].forEach((function(e){return!e.shouldUnmount&&e(w)}))};n()&&o((function(){return e=window,r=_.RESIZE_EVENT,t=i(update,100),void(e&&o(e.addEventListener,r,t,n||!1));var e,r,t,n}));var x={get:function(e){return w[e]},set:function(e){var r=e.screen,t=e.window;r&&(w.screen=r),t&&(w.window=t)},update:update,addEventListener:function(e,r){e&&u(r)&&(E[e]=E[e]||[],E[e].push(r))},removeEventListener:function(e,r){e&&u(r)&&a(E[e])&&(E[e]=E[e].filter((function(e){return e!==r})))}};function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread2(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _extends(){return(_extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function _objectWithoutProperties(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function _slicedToArray(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,i=[],a=!0,u=!1;try{for(t=t.call(e);!(a=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==t.return||t.return()}finally{if(u)throw o}}return i}(e,r)||_unsupportedIterableToArray(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(e){return function(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var T={},addThemeEvent=function(e,r){if(e&&u(r))return T[e]=T[e]||[],T[e].push(r),T[e].length-1},removeThemeEvent=function(e,r){e&&T[e]&&(r||0===r)&&(f(r)?T[e].splice(r,1):u(r)&&a(T[e])&&(T[e]=T[e].filter((function(e){return e!==r}))))},fireThemeEvent=function(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];a(T[e])&&T[e].forEach((function(e){return e.apply(void 0,t)}))},O={entries:[["$xsmall",1],["$small",320],["$medium",768],["$large",1024],["$xlarge",1366]],hash:{},indexes:{}},buildSizeMapParts=function(){O.indexes=O.entries.reduce((function(e,r,t){return e[r[0]]=t,e[t]=r[0],O.hash[r[0]]=r[1],e}),{})},setSizes=function(e){return l(e)?(c(e,(function(r,t){var n=O.indexes[r];if(!s(n))return d("Invalid ".concat(r," for theme size! Allowed keys are xsmall | small | medium | large | xlarge"),"warn");var o=p(e[r]);if(!o||!O.entries[n])return d("Invalid size entry. Size must be a number and the size entry must exist!","Size: ".concat(o),"Entry: ".concat(O.entries[n]),"warn");O.entries[n]=[r,o]})),buildSizeMapParts(),O):d("setDimensions method requires an argument of type 'Object'.\nReceived: ",e,"error")},getSize=function(e){var r=f(e)&&e||p(e),t=O.entries.reduce((function(e,t){var n=_slicedToArray(t,2),o=n[0],i=n[1];return r>=i&&(e?i>O.hash[e]&&(e=o):e=o),e}),"$xsmall");return[t,O.hash[t]]},getMergeSizes=function(e){return O.entries.slice(0,O.indexes[e]+1).map((function(e){var r=_slicedToArray(e,2),t=r[0];return r[1],t}))};buildSizeMapParts();var S,getSizeMap=function(){return O},A=(_defineProperty(S={m:"margin",mT:"marginTop",mB:"marginBottom",mR:"marginRight",mL:"marginLeft",mH:"marginHorizontal",mV:"marginVertical",p:"padding",pT:"paddingTop",pB:"paddingBottom",pR:"paddingRight",pL:"paddingLeft",pH:"paddingHorizontal",pV:"paddingVertical",bC:"borderColor",bCT:"borderTopColor",bCB:"borderBottomColor",bCR:"borderRightColor",bCL:"borderLeftColor",bW:"borderWidth",bS:"borderStyle"},"bC","borderColor"),_defineProperty(S,"bRad","borderRadius"),_defineProperty(S,"c","color"),_defineProperty(S,"bg","background"),_defineProperty(S,"bgC","backgroundColor"),_defineProperty(S,"d","display"),_defineProperty(S,"ovf","overflow"),_defineProperty(S,"ovfX","overflowX"),_defineProperty(S,"ovfY","overflowY"),_defineProperty(S,"pos","position"),_defineProperty(S,"z","zIndex"),_defineProperty(S,"tp","top"),_defineProperty(S,"bt","bottom"),_defineProperty(S,"btm","bottom"),_defineProperty(S,"lt","left"),_defineProperty(S,"rt","right"),_defineProperty(S,"bxS","boxShadow"),_defineProperty(S,"op","opacity"),_defineProperty(S,"ptrE","pointerEvents"),_defineProperty(S,"otl","outline"),_defineProperty(S,"fl","flex"),_defineProperty(S,"flD","flexDirection"),_defineProperty(S,"flWr","flexWrap"),_defineProperty(S,"flB","flexBasis"),_defineProperty(S,"flS","flexShrink"),_defineProperty(S,"jtC","justifyContent"),_defineProperty(S,"alC","alignContent"),_defineProperty(S,"alS","alignSelf"),_defineProperty(S,"alI","alignItems"),_defineProperty(S,"w","width"),_defineProperty(S,"h","height"),_defineProperty(S,"minH","minHeight"),_defineProperty(S,"maxH","maxHeight"),_defineProperty(S,"minW","minWidth"),_defineProperty(S,"maxW","maxWidth"),_defineProperty(S,"ftF","fontFamily"),_defineProperty(S,"ftSz","fontSize"),_defineProperty(S,"ftS","fontStyle"),_defineProperty(S,"ftWt","fontWeight"),_defineProperty(S,"lnH","lineHeight"),_defineProperty(S,"ltrS","letterSpacing"),_defineProperty(S,"txAl","textAlign"),_defineProperty(S,"txDc","textDecoration"),_defineProperty(S,"txDL","textDecorationLine"),S),j={OS:"web",select:function(e){return l(e)&&e.web},Version:"ReTheme"},getRNPlatform=function(){return j},$=["$class","$className"],buildPlatforms=function(e){var r,t,n=Object.keys(e).filter((function(r){return e[r]}));return(r=getRNPlatform(),t=["$"+v(r,"OS")],"web"!==v(r,"OS")&&t.push("$native"),t.concat([_.PLATFORM.ALL])).reduce((function(r,t){return!1!==e[t]&&-1===r.indexOf(t)&&r.unshift(t),r}),n)},C=function buildSizedThemes(e,r,t){return y(e,(function(r,n,o){if(A[r]&&(h(e,r),e[A[r]]=n),!l(n))return o;if(r===t){var i=m(o,n);return h(e,[t]),i}var a=buildSizedThemes(n,o[r]||{},t);return b(a)||(o[r]=a),o}),r)},updatePlatformTheme=function(e,r,t){if(!l(t))return t;var n=t.$class,o=t.$className,i=_objectWithoutProperties(t,$),a=getPlatformTheme(function(e,r){var t=getSizeMap(),n=[],o=Object.keys(e).reduce((function(o,i){return"$"!==i[0]||t.hash[i]?o[i]=e[i]:-1!==r.indexOf(i)&&n.push(e[i]),o}),{});return n.length?m.apply(void 0,n):o}(i,e),e,r),u=o||n;return u&&(a.$class=u),a},getPlatformTheme=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e?y(e,(function(e,n,o){return o[e]=updatePlatformTheme(r,t,n),o}),e):e},L={},getCurrentTheme=function(){return L},getTheme=function(){for(var e=getCurrentTheme(),r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return m.apply(void 0,_toConsumableArray(t.reduce((function(r,t){var n=l(t)?t:g(t)||a(t)?v(e,t):null;return n&&r.push(n),r}),[])))},k=["$xsmall","$small","$medium","$large","$xlarge"],I={},mergeWithDefault=function(e,r,t){return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=getRNPlatform();return Object.keys(getSizeMap().hash).reduce((function(r,t){var n=C(e,e[t]||{},t);return b(n)||(r[t]=n),r}),getPlatformTheme(e,buildPlatforms(r),t))}(m(r&&e!==r?r:{},e),t)},buildTheme=function(e,r,t,n,o){if(!l(e))return e;l(o)||(o={});var i=_slicedToArray(getSize(r),2),a=i[0],u={key:a,size:i[1],width:r,height:t};if(I&&e===I.theme)return useCachedTheme(I,u);var f=mergeWithDefault(e,n,o);f.$xsmall,f.$small,f.$medium,f.$large,f.$xlarge;var d=_objectWithoutProperties(f,k);return configureBuiltTheme(I={extraTheme:d,mergedTheme:f,theme:e,key:a},u)},useCachedTheme=function(e,r){return r.key!==e.key?configureBuiltTheme(e,r):o((function(){var e=getCurrentTheme();return fireThemeEvent(_.BUILD_EVENT,e),e}))},configureBuiltTheme=function(e,r){var t=e.mergedTheme,n=e.extraTheme;I.key=r.key;var o=r.size?function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=getMergeSizes(r);return m.apply(void 0,[t].concat(_toConsumableArray(n.reduce((function(r,t){return e[t]&&r.push(e[t]),r}),[]))))}(t,r.key,n):n;return o.get=getTheme,o.RTMeta=_objectSpread2(_objectSpread2({},o.RTMeta),r),L=o,fireThemeEvent(_.BUILD_EVENT,o),o},R={},setDefaultTheme=function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!l(e))return console.warn("setDefaultTheme method requires an theme object as the first argument. Received: ",e);R=r?m(R,e):e;var t=x.get("window"),n=buildTheme(R,t.width,t.height);return n},getDefaultTheme=function(){return R},D=e.createContext(getDefaultTheme()),useTheme=function(){return r(D)};export{_ as C,x as D,D as R,_slicedToArray as _,_extends as a,buildTheme as b,getDefaultTheme as c,getCurrentTheme as d,_defineProperty as e,_toConsumableArray as f,getSize as g,_objectSpread2 as h,getSizeMap as i,getMergeSizes as j,addThemeEvent as k,fireThemeEvent as l,setDefaultTheme as m,_objectWithoutProperties as n,removeThemeEvent as r,setSizes as s,useTheme as u};
//# sourceMappingURL=useTheme-200bf6f7.js.map
