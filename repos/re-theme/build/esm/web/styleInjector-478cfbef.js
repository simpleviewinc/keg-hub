import{hasDomAccess as e,omitKeys as t,pickKeys as r,isArr as n,exists as o,isStr as a,hashString as c,hyphenator as i,flatArr as l,eitherArr as s,isObj as u}from"@keg-hub/jsutils";import{l as f,C as d,u as m,o as p,a as v}from"./useTheme-5c3931da.js";import y,{useMemo as h}from"react";import S from"react-native-web/dist/modules/prefixStyles";import b from"react-native-web/dist/exports/StyleSheet/flattenStyle";import E from"react-native-web/dist/exports/StyleSheet/createReactDOMStyle";import g from"react-native-web/dist/exports/StyleSheet/createCompileableStyle";var C,T={important:[],filter:["aspectRatio","elevation","overlayColor","resizeMode","tintColor","backgroundSize","animationKeyframes","placeholderTextColor","pointerEvents","scrollbarWidth"]},_=e(),j=new Set,getKegSheet=function(){return C=C||document.head.querySelector(d.KEG_STYLES_TAG_ID)},getSelector=function(e,t,r){var filterWithPrefix=function(e){return e&&r?e.startsWith(r):e},i=!!o(e)&&(n(e)?e.filter(filterWithPrefix).pop():a(e)&&e.split(" ").filter(filterWithPrefix).pop()),l="keg-".concat(c(t));return{hashClass:l,selector:i?".".concat(i.trim(),".").concat(l).trim():".".concat(l).trim()}},addStylesToDom=function(e,t){if(_&&t&&!function(e){return j.has(e)}(e)){j.add(e);var r=getKegSheet();r.sheet.insertRule("@media all {".concat(t.all,"}"))}};f(d.BUILD_EVENT,(function(){j.clear(),getKegSheet().textContent=""})),function(){if(_){if(C=document.head.querySelector(d.KEG_STYLES_TAG_ID))return C;(C=document.createElement("style")).id=d.KEG_STYLES_TAG_ID,document.head.append(C)}}();var k=Object.freeze({}),createBlock=function(e,t){var r=T.important.concat(null==t?void 0:t.important),o=S(E(e)),a=Object.keys(o).map((function(e){var t=function(e,t,r){return r.includes(e)?"".concat(t," !important"):t}(e,o[e],r),a=i(e);return n(t)?t.map((function(e){return"".concat(a,":").concat(e)})).join(";"):"".concat(a,":").concat(t)})).sort().join(";");return"{".concat(a,"}")},convertToCss=function(e,o){return l(s(e,[e])).reduce((function(e,a){if(!u(a))return e;var c=function(e,o){var a=n(o)?T.filter.concat(o):T.filter;return{style:t(e,a),filtered:r(e,a)}}(a,null==o?void 0:o.filter),i=c.style,l=c.filtered;Object.assign(e.filtered,l);var s=b(i),f=g(s);return e.blocks.push(createBlock(f,o)),e}),{blocks:[],filtered:{}})},useStyleTag=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2?arguments[2]:void 0;o=u(o)?o:k;var a=m(),c=null==a||null===(t=a.RTMeta)||void 0===t?void 0:t.size,i=null==a||null===(r=a.RTMeta)||void 0===r?void 0:r.key;return h((function(){var t=convertToCss(e,o),r=t.blocks,a=t.filtered,c=getSelector(n,r.join(""),"keg"),i=c.hashClass,l=c.selector,u=r.reduce((function(e,t){var r="".concat(l).concat(t);return e.all+=r,e.rules.push(r),e}),{all:"",rules:[]});return addStylesToDom(l,u),{css:u,filteredStyle:a,classList:s(n,[n]).concat([i])}}),[e,n,c,i,o])},w=y.forwardRef((function(e,t){var r=e.Component,o=e.children,a=e.config,c=e.className,i=e.style,l=p(e,["Component","children","config","className","style"]),s=a.className,u=useStyleTag(i,c||s,a),f=u.classList,d=u.filteredStyle;return y.createElement(r,v({},l,{style:d,ref:t,className:n(f)?f.join(" "):f}),o)})),StyleInjector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y.forwardRef((function(r,n){var o=r.style,a=p(r,["style"]);return o?y.createElement(w,v({},a,{style:o,config:t,Component:e,ref:n})):y.createElement(e,v({},a,{style:o,ref:n}))}))};export{StyleInjector as S,convertToCss as a,createBlock as c,useStyleTag as u};
//# sourceMappingURL=styleInjector-478cfbef.js.map
