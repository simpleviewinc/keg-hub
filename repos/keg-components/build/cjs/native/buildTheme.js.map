{"version":3,"file":"buildTheme.js","sources":["../../../src/utils/styles/buildTheme.js"],"sourcesContent":["import { getThemeDefaults } from '../../theme/themeDefaults'\nimport { platformFlatten } from './platformFlatten'\nimport { isFunc, isObj, validate, deepMerge, flatMap } from '@keg-hub/jsutils'\n\n/**\n * builds a single theme object with all combinations of colorTypes and state keys\n * @param {Function} themeFn - a function of form (state, colorType) => {} that generates a theme object for that state and colorType\n * @param {Object} options - optional parameters\n * @param {Array<String>} options.states - array of possible component states. Uses theme/defaults.json by default\n * @param {Array<String>} options.colorTypes - array of possible component color types. Uses theme/defaults.json by default\n * @param {Array<Object>} options.inheritFrom - array of parent theme objects from which this theme will inherit and override styles\n *\n * @returns { Object } a theme with every colorType and state\n */\nexport const buildTheme = (themeFn, options = {}) => {\n  const defaults = getThemeDefaults()\n  const defaultColorTypes = Object.keys(defaults.colors.types)\n  const defaultStateTypes = Object.keys(defaults.states.types)\n\n  const [valid] = validate(\n    { themeFn, options },\n    { themeFn: isFunc, options: isObj },\n    { prefix: '[buildTheme] Invalid theme setup.' }\n  )\n  if (!valid) return\n\n  const {\n    states = defaultStateTypes,\n    colorTypes = defaultColorTypes,\n    inheritFrom = [],\n  } = options\n\n  // generate all pairings of states and color types => [ [state, color ] ... ]\n  const combinations = pairsOf(states, colorTypes)\n\n  // create a single theme object of structure [colorType].[state].<properties>\n  const themeWithTypes = combinations.reduce(themeReducer(themeFn), {})\n\n  // merge with any parents, letting the new theme override parents\n  return platformFlatten(deepMerge(...inheritFrom, themeWithTypes))\n}\n\n/**\n * @param {Array} states\n * @param {Array} colorTypes\n *\n * @returns {Array} array of pairs of states and color types\n */\nconst pairsOf = (states, colorTypes) =>\n  flatMap(states, state => colorTypes.map(type => [ state, type ]))\n\n/**\n * Uses themeFn to create the theme for the given state and colorType.\n * @param {Function} themeFn\n *\n * @returns {Object} the merged object with totalTheme, which includes all the other colorTypes\n */\nconst themeReducer = themeFn => {\n  return (totalTheme, [ state, colorType ]) =>\n    deepMerge(totalTheme, themeForType(themeFn, state, colorType))\n}\n\n/**\n * @param {Function} themeFn - function that produces the theme object\n * @param {String} state - state of component\n * @param {String} colorType - color type of component\n *\n * @returns {Object} the theme object for the specified state and colorType\n */\nconst themeForType = (themeFn, state, colorType) => ({\n  [colorType]: {\n    [state]: themeFn(state, colorType),\n  },\n})\n"],"names":["buildTheme","themeFn","options","defaults","getThemeDefaults","defaultColorTypes","Object","keys","colors","types","defaultStateTypes","states","validate","isFunc","isObj","prefix","valid","colorTypes","inheritFrom","combinations","pairsOf","themeWithTypes","reduce","themeReducer","platformFlatten","deepMerge","flatMap","state","map","type","totalTheme","colorType","themeForType"],"mappings":";;;;;;;;;;IAcaA,UAAU,GAAG,SAAbA,UAAa,CAACC,OAAD,EAA2B;AAAA,MAAjBC,OAAiB,uEAAP,EAAO;AACnD,MAAMC,QAAQ,GAAGC,8BAAgB,EAAjC;AACA,MAAMC,iBAAiB,GAAGC,MAAM,CAACC,IAAP,CAAYJ,QAAQ,CAACK,MAAT,CAAgBC,KAA5B,CAA1B;AACA,MAAMC,iBAAiB,GAAGJ,MAAM,CAACC,IAAP,CAAYJ,QAAQ,CAACQ,MAAT,CAAgBF,KAA5B,CAA1B;AAHmD,kBAKnCG,gBAAQ,CACtB;AAAEX,IAAAA,OAAO,EAAPA,OAAF;AAAWC,IAAAA,OAAO,EAAPA;AAAX,GADsB,EAEtB;AAAED,IAAAA,OAAO,EAAEY,cAAX;AAAmBX,IAAAA,OAAO,EAAEY;AAA5B,GAFsB,EAGtB;AAAEC,IAAAA,MAAM,EAAE;AAAV,GAHsB,CAL2B;AAAA;AAAA,MAK5CC,KAL4C;AAUnD,MAAI,CAACA,KAAL,EAAY;AAVuC,wBAgB/Cd,OAhB+C,CAajDS,MAbiD;AAAA,MAajDA,MAbiD,gCAaxCD,iBAbwC;AAAA,4BAgB/CR,OAhB+C,CAcjDe,UAdiD;AAAA,MAcjDA,UAdiD,oCAcpCZ,iBAdoC;AAAA,6BAgB/CH,OAhB+C,CAejDgB,WAfiD;AAAA,MAejDA,WAfiD,qCAenC,EAfmC;AAmBnD,MAAMC,YAAY,GAAGC,OAAO,CAACT,MAAD,EAASM,UAAT,CAA5B,CAnBmD;AAsBnD,MAAMI,cAAc,GAAGF,YAAY,CAACG,MAAb,CAAoBC,YAAY,CAACtB,OAAD,CAAhC,EAA2C,EAA3C,CAAvB,CAtBmD;AAyBnD,SAAOuB,+BAAe,CAACC,iBAAS,MAAT,sDAAaP,WAAb,UAA0BG,cAA1B,GAAD,CAAtB;AACD;AAQD,IAAMD,OAAO,GAAG,SAAVA,OAAU,CAACT,MAAD,EAASM,UAAT;AAAA,SACdS,eAAO,CAACf,MAAD,EAAS,UAAAgB,KAAK;AAAA,WAAIV,UAAU,CAACW,GAAX,CAAe,UAAAC,IAAI;AAAA,aAAI,CAAEF,KAAF,EAASE,IAAT,CAAJ;AAAA,KAAnB,CAAJ;AAAA,GAAd,CADO;AAAA,CAAhB;AASA,IAAMN,YAAY,GAAG,SAAfA,YAAe,CAAAtB,OAAO,EAAI;AAC9B,SAAO,UAAC6B,UAAD;AAAA;AAAA,QAAeH,KAAf;AAAA,QAAsBI,SAAtB;AAAA,WACLN,iBAAS,CAACK,UAAD,EAAaE,YAAY,CAAC/B,OAAD,EAAU0B,KAAV,EAAiBI,SAAjB,CAAzB,CADJ;AAAA,GAAP;AAED,CAHD;AAYA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAC/B,OAAD,EAAU0B,KAAV,EAAiBI,SAAjB;AAAA,uDAClBA,SADkB,gDAEhBJ,KAFgB,EAER1B,OAAO,CAAC0B,KAAD,EAAQI,SAAR,CAFC;AAAA,CAArB;;;;"}