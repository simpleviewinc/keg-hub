{"version":3,"file":"buildTheme.js","sources":["../../../src/utils/styles/buildTheme.js"],"sourcesContent":["import defaults from '../../theme/defaults'\nimport { platformFlatten } from './platformFlatten'\nimport { isFunc, isObj, validate, deepMerge, flatMap } from '@keg-hub/jsutils'\n\nconst defaultColorTypes = Object.keys(defaults.colors.types)\nconst defaultStateTypes = Object.keys(defaults.states.types)\n\n/**\n * builds a single theme object with all combinations of colorTypes and state keys\n * @param {Function} themeFn - a function of form (state, colorType) => {} that generates a theme object for that state and colorType\n * @param {Object} options - optional parameters\n * @param {Array<String>} options.states - array of possible component states. Uses theme/defaults.json by default\n * @param {Array<String>} options.colorTypes - array of possible component color types. Uses theme/defaults.json by default\n * @param {Array<Object>} options.inheritFrom - array of parent theme objects from which this theme will inherit and override styles\n *\n * @returns { Object } a theme with every colorType and state\n */\nexport const buildTheme = (themeFn, options = {}) => {\n  const [valid] = validate(\n    { themeFn, options },\n    { themeFn: isFunc, options: isObj },\n    { prefix: '[buildTheme] Invalid theme setup.' }\n  )\n  if (!valid) return\n\n  const {\n    states = defaultStateTypes,\n    colorTypes = defaultColorTypes,\n    inheritFrom = [],\n  } = options\n\n  // generate all pairings of states and color types => [ [state, color ] ... ]\n  const combinations = pairsOf(states, colorTypes)\n\n  // create a single theme object of structure [colorType].[state].<properties>\n  const themeWithTypes = combinations.reduce(themeReducer(themeFn), {})\n\n  // merge with any parents, letting the new theme override parents\n  return platformFlatten(deepMerge(...inheritFrom, themeWithTypes))\n}\n\n/**\n * @param {Array} states\n * @param {Array} colorTypes\n *\n * @returns {Array} array of pairs of states and color types\n */\nconst pairsOf = (states, colorTypes) =>\n  flatMap(states, state => colorTypes.map(type => [ state, type ]))\n\n/**\n * Uses themeFn to create the theme for the given state and colorType.\n * @param {Function} themeFn\n *\n * @returns {Object} the merged object with totalTheme, which includes all the other colorTypes\n */\nconst themeReducer = themeFn => {\n  return (totalTheme, [ state, colorType ]) =>\n    deepMerge(totalTheme, themeForType(themeFn, state, colorType))\n}\n\n/**\n * @param {Function} themeFn - function that produces the theme object\n * @param {String} state - state of component\n * @param {String} colorType - color type of component\n *\n * @returns {Object} the theme object for the specified state and colorType\n */\nconst themeForType = (themeFn, state, colorType) => ({\n  [colorType]: {\n    [state]: themeFn(state, colorType),\n  },\n})\n"],"names":["defaultColorTypes","Object","keys","defaults","colors","types","defaultStateTypes","states","buildTheme","themeFn","options","validate","isFunc","isObj","prefix","valid","colorTypes","inheritFrom","combinations","pairsOf","themeWithTypes","reduce","themeReducer","platformFlatten","deepMerge","flatMap","state","map","type","totalTheme","colorType","themeForType"],"mappings":";;;;;AAIA,IAAMA,iBAAiB,GAAGC,MAAM,CAACC,IAAP,CAAYC,QAAQ,CAACC,MAAT,CAAgBC,KAA5B,CAA1B;AACA,IAAMC,iBAAiB,GAAGL,MAAM,CAACC,IAAP,CAAYC,QAAQ,CAACI,MAAT,CAAgBF,KAA5B,CAA1B;IAYaG,UAAU,GAAG,SAAbA,UAAa,CAACC,OAAD,EAA2B;AAAA,MAAjBC,OAAiB,uEAAP,EAAO;AAAA,kBACnCC,QAAQ,CACtB;AAAEF,IAAAA,OAAO,EAAPA,OAAF;AAAWC,IAAAA,OAAO,EAAPA;AAAX,GADsB,EAEtB;AAAED,IAAAA,OAAO,EAAEG,MAAX;AAAmBF,IAAAA,OAAO,EAAEG;AAA5B,GAFsB,EAGtB;AAAEC,IAAAA,MAAM,EAAE;AAAV,GAHsB,CAD2B;AAAA;AAAA,MAC5CC,KAD4C;AAMnD,MAAI,CAACA,KAAL,EAAY;AANuC,wBAY/CL,OAZ+C,CASjDH,MATiD;AAAA,MASjDA,MATiD,gCASxCD,iBATwC;AAAA,4BAY/CI,OAZ+C,CAUjDM,UAViD;AAAA,MAUjDA,UAViD,oCAUpChB,iBAVoC;AAAA,6BAY/CU,OAZ+C,CAWjDO,WAXiD;AAAA,MAWjDA,WAXiD,qCAWnC,EAXmC;AAenD,MAAMC,YAAY,GAAGC,OAAO,CAACZ,MAAD,EAASS,UAAT,CAA5B,CAfmD;AAkBnD,MAAMI,cAAc,GAAGF,YAAY,CAACG,MAAb,CAAoBC,YAAY,CAACb,OAAD,CAAhC,EAA2C,EAA3C,CAAvB,CAlBmD;AAqBnD,SAAOc,eAAe,CAACC,SAAS,MAAT,4BAAaP,WAAb,UAA0BG,cAA1B,GAAD,CAAtB;AACD;AAQD,IAAMD,OAAO,GAAG,SAAVA,OAAU,CAACZ,MAAD,EAASS,UAAT;AAAA,SACdS,OAAO,CAAClB,MAAD,EAAS,UAAAmB,KAAK;AAAA,WAAIV,UAAU,CAACW,GAAX,CAAe,UAAAC,IAAI;AAAA,aAAI,CAAEF,KAAF,EAASE,IAAT,CAAJ;AAAA,KAAnB,CAAJ;AAAA,GAAd,CADO;AAAA,CAAhB;AASA,IAAMN,YAAY,GAAG,SAAfA,YAAe,CAAAb,OAAO,EAAI;AAC9B,SAAO,UAACoB,UAAD;AAAA;AAAA,QAAeH,KAAf;AAAA,QAAsBI,SAAtB;AAAA,WACLN,SAAS,CAACK,UAAD,EAAaE,YAAY,CAACtB,OAAD,EAAUiB,KAAV,EAAiBI,SAAjB,CAAzB,CADJ;AAAA,GAAP;AAED,CAHD;AAYA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACtB,OAAD,EAAUiB,KAAV,EAAiBI,SAAjB;AAAA,6BAClBA,SADkB,sBAEhBJ,KAFgB,EAERjB,OAAO,CAACiB,KAAD,EAAQI,SAAR,CAFC;AAAA,CAArB;;;;"}