{"version":3,"file":"filePicker.js","sources":["../../../src/components/filePicker/filePicker.js"],"sourcesContent":["import React, { useState, useRef, useCallback, useEffect } from 'react'\nimport { useThemePath } from '../../hooks'\nimport PropTypes from 'prop-types'\nimport { P } from '../typography'\nimport { Button } from '../button'\nimport { View } from 'KegView'\nimport { get } from '@keg-hub/jsutils'\nimport { useThemeTypeAsClass } from 'KegTypeAsClass'\nimport { StyleInjector } from '@keg-hub/re-theme/styleInjector'\nimport { Input as KegInput } from '../internal/input.web'\n\n/**\n * Wrap the internal component with the Styles Injector Hoc\n * <br/>This allows us to add the styles as css classes\n */\nconst Input = StyleInjector(KegInput, {\n  displayName: 'FilePickerInput',\n  className: 'keg-file-picker-input',\n})\n\n/**\n * A component for selecting files from the user's system. Looks better than a basic input element,\n * and accepts style objects for styling further\n * @param {Object} props - props object. Accepts all standard <input /> props which will be passed to the input element. Additional props:\n * @param {String} props.title - the text inside the button\n * @param {Object} props.style - style for the wrapping View\n * @param {Object} props.buttonStyle - style for the button\n * @param {Object} props.fileStyle - style for the file name text\n * @param {Object} props.themePath - theme type path for everything except the button\n * @param {Object} props.buttonThemePath - theme type path for the button itself (@see Button)\n * @param {Boolean} props.showFile - if true, it will show the file name next to the input\n * @param {Function} props.onFilePicked - function called when a file was selected and handles extracting the file for you: file => { ... }\n * @param {Boolean} props.openOnMount - opens filepicker on component mount\n * @param {Object} ref - an optional ref to the underlying input element\n */\nexport const FilePicker = React.forwardRef((props, ref) => {\n  const {\n    className,\n    onChange,\n    title,\n    children,\n    style = {},\n    showFile = true,\n    onFilePicked,\n    themePath = 'filePicker.default',\n    buttonThemePath = 'button.contained.default',\n    capture,\n    openOnMount = false,\n    ...args\n  } = props\n\n  const componentTheme = useThemePath(themePath)\n\n  // store the file selected by the user\n  const [ file, setFile ] = useState({})\n\n  // handle user selecting a file\n  const handleInputChange = useCallback(\n    event => {\n      onChange && onChange(event)\n\n      const file = event.target.files[0]\n      file && onFilePicked && onFilePicked(file)\n      file && setFile(file)\n    },\n    [ onChange, onFilePicked, setFile ]\n  )\n\n  // make an input ref so that we can call the input's click() handler to start picking files\n  // when the user clicks the button\n  const refToInput = useRef()\n\n  const clickInput = useCallback(\n    () => refToInput.current && refToInput.current.click(),\n    [refToInput]\n  )\n\n  // if openOnMount is set to true, then immediately open the file picker\n  useEffect(() => {\n    openOnMount && clickInput()\n  }, [])\n\n  return (\n    <View\n      className={useThemeTypeAsClass(\n        themePath || type,\n        'keg-filepicker',\n        className\n      )}\n      style={[ get(componentTheme, 'main'), style ]}\n    >\n      <Button\n        content={title}\n        onClick={clickInput}\n        style={get(componentTheme, 'content.button')}\n        themePath={buttonThemePath}\n      >\n        { children }\n      </Button>\n\n      {\n        // show the file name if the flag is set for it\n        showFile && (\n          <P style={get(componentTheme, 'content.file')}>{ file.name }</P>\n        )\n      }\n\n      { /* this input is hidden from the user, but is still used for selecting a file */ }\n      <Input\n        {...args}\n        ref={input => {\n          ref && (ref.current = input)\n          refToInput.current = input\n        }}\n        onChange={handleInputChange}\n        style={get(componentTheme, 'content.input')}\n        type='file'\n        capture={capture}\n      />\n    </View>\n  )\n})\n\nFilePicker.propTypes = {\n  title: PropTypes.string,\n  style: PropTypes.object,\n  buttonStyle: PropTypes.object,\n  fileStyle: PropTypes.object,\n  themePath: PropTypes.string,\n  buttonThemePath: PropTypes.string,\n  onChange: PropTypes.func,\n  onFilePicked: PropTypes.func,\n  showFile: PropTypes.bool,\n}\n"],"names":["Input","StyleInjector","KegInput","displayName","className","FilePicker","React","forwardRef","props","ref","onChange","title","children","style","showFile","onFilePicked","themePath","buttonThemePath","capture","openOnMount","args","componentTheme","useThemePath","useState","file","setFile","handleInputChange","useCallback","event","target","files","refToInput","useRef","clickInput","current","click","useEffect","useThemeTypeAsClass","type","get","name","input"],"mappings":"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"}