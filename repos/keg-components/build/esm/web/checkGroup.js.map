{"version":3,"file":"checkGroup.js","sources":["../../../src/components/form/checkGroup/checkGroup.js"],"sourcesContent":["import React, { useCallback, useImperativeHandle, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { View } from 'KegView'\nimport { Text } from '../../typography/text'\nimport { Checkbox } from 'KegCheckbox'\nimport { useStyle } from '@keg-hub/re-theme'\nimport { useClassList } from 'KegClassList'\nimport { useChildrenWithRefs } from '../../../hooks/useChildrenWithRefs'\nimport { mapObj, noOp } from '@keg-hub/jsutils'\n\n/**\n * Simple header for CheckGroup, without a checkbox\n * @param {Object} props\n * @param {string} props.title - title of header\n * @param {Object} props.style - style rules to apply to the Text element\n * @param {*} props.* - remaining props are passed to the Text element\n */\nconst SimpleHeader = React.forwardRef((props, ref) => {\n  const { title, className, style, ...rest } = props\n\n  // add no-op handle here just for consistency with other header\n  useImperativeHandle(ref, () => ({ isChecked: undefined, setChecked: noOp }))\n\n  const textStyle = useStyle('form.checkGroup.simpleHeader.main', style)\n  return (\n    <Text\n      className={className}\n      style={textStyle}\n      {...rest}\n    >\n      { title }\n    </Text>\n  )\n})\n\n/**\n * Header for CheckGroup, with a checkbox for select-all functionality\n * @param {Object} props\n * @param {string} props.title - title of header\n * @param {Object} props.style - style rules to apply to the header\n * @param {Function?} props.onPress - handler for checkbox press\n * @param {boolean} props.checked - initial value of header checkbox\n */\nconst CheckboxHeader = React.forwardRef((props, ref) => {\n  const { title, className, style, onPress, checked } = props\n  const headerStyles = useMemo(\n    () => ({\n      main: style,\n      content: {\n        right: {},\n      },\n    }),\n    [style]\n  )\n\n  const onChangeHandler = useCallback((_, val) => onPress?.(val), [onPress])\n\n  return (\n    <Checkbox\n      RightComponent={title}\n      rightClassName={className}\n      styles={headerStyles}\n      checked={checked}\n      onChange={onChangeHandler}\n      ref={ref}\n      close\n    />\n  )\n})\n\n/**\n * A group of checkbox items with a header.\n * Will include a select-all checkbox in the header IF you define the children as a function (@see story examples)\n * @param {Object} props\n * @param {string} props.className - css class name\n * @param {string} props.headerClassName - css class name for header text\n * @param {string} props.title - title of the group\n * @param {boolean?} props.initChecked - initial checked value of the group header box, if you are using it\n * @param {boolean?} props.showHeaderCheckbox - true if you want a group header check box, with select-all functionality\n * @param {boolean?} props.showHeader - true by default. If false, hides the header entirely, only showing children\n * @param {Function?} props.onGroupPress - handler of header checkbox\n * @param {*} props.children - components in the group (@see CheckboxGroup.Item)\n * @param {Object?} props.styles\n * @param {Object?} props.styles.main\n * @param {Object?} props.styles.header\n */\nexport const CheckGroup = React.forwardRef((props, ref) => {\n  const {\n    className,\n    headerClassName,\n    title,\n    children,\n    styles,\n    initChecked = false,\n    onGroupPress,\n    showHeaderCheckbox = false,\n    showHeader = true,\n  } = props\n\n  const groupStyles = useStyle('form.checkGroup', styles)\n\n  // get children updated with ref props, and the refs themselves\n  const [ childrenWithProps, childRefs ] = useChildrenWithRefs(\n    children,\n    showHeaderCheckbox\n  )\n\n  // callback that manages select-all behavior on click of the header checkbox\n  const headerCheckHandler = useCallback(\n    checked => {\n      onGroupPress?.(checked)\n      mapObj(childRefs.current, (_, child) => child?.setChecked?.(checked))\n    },\n    [childRefs]\n  )\n\n  const Header = () =>\n    showHeaderCheckbox ? (\n      <CheckboxHeader\n        className={headerClassName}\n        style={groupStyles?.header}\n        title={title}\n        onPress={showHeaderCheckbox && headerCheckHandler}\n        checked={showHeaderCheckbox ? initChecked : undefined}\n        ref={ref}\n      />\n    ) : (\n      <SimpleHeader\n        className={headerClassName}\n        style={groupStyles?.header}\n        title={title}\n        ref={ref}\n      />\n    )\n\n  return (\n    <View\n      className={useClassList('keg-check-group', className)}\n      style={groupStyles?.main}\n    >\n      { showHeader && <Header /> }\n      { childrenWithProps }\n    </View>\n  )\n})\n\nCheckGroup.Item = Checkbox\n\nCheckGroup.propTypes = {\n  className: PropTypes.oneOfType([ PropTypes.array, PropTypes.string ]),\n  headerClassName: PropTypes.oneOfType([ PropTypes.array, PropTypes.string ]),\n  title: PropTypes.string,\n  initChecked: PropTypes.bool,\n  showHeaderCheckbox: PropTypes.bool,\n  showHeader: PropTypes.bool,\n  onGroupPress: PropTypes.func,\n  styles: PropTypes.oneOfType([ PropTypes.object, PropTypes.array ]),\n}\n"],"names":["SimpleHeader","React","forwardRef","props","ref","title","className","style","rest","useImperativeHandle","isChecked","undefined","setChecked","noOp","textStyle","useStyle","CheckboxHeader","onPress","checked","headerStyles","useMemo","main","content","right","onChangeHandler","useCallback","_","val","CheckGroup","headerClassName","children","styles","initChecked","onGroupPress","showHeaderCheckbox","showHeader","groupStyles","useChildrenWithRefs","childrenWithProps","childRefs","headerCheckHandler","mapObj","current","child","Header","header","useClassList","Item","Checkbox"],"mappings":"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"}